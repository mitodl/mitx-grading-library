<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../img/favicon.ico">

    
    <title>AsciiMath Renderer Definitions - MITxGraders</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../../css/base.min.css" rel="stylesheet">
    <link href="../../css/cinder.min.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/vs-min.min.css">
        
    
    <link href="../../css/extra.css" rel="stylesheet">
    <link href="../../css/cinder_tweaks.css" rel="stylesheet">
    <link href="../../css/readthedocs.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    

     
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            
              <a class="navbar-brand" href="../..">MITxGraders</a>
            
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../..">Overview</a>
</li>

                        
                            
<li >
    <a href="../../edx/">edX Syntax</a>
</li>

                        
                            
<li >
    <a href="../../graders/">Introduction to Graders</a>
</li>

                        
                            
<li >
    <a href="../../item_grader/">ItemGrader</a>
</li>

                        
                            
<li >
    <a href="../../string_grader/">StringGrader</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Grading Math <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../formula_grader/">FormulaGrader</a>
</li>

                        
                            
<li >
    <a href="../numerical_grader/">NumericalGrader</a>
</li>

                        
                            
<li >
    <a href="../matrix_grader/matrix_grader/">MatrixGrader</a>
</li>

                        
                            
<li >
    <a href="../sampling/">Sampling Sets</a>
</li>

                        
                            
<li >
    <a href="../functions_and_constants/">Functions and Constants List</a>
</li>

                        
                            
<li >
    <a href="../user_functions/">User-Defined Functions</a>
</li>

                        
                            
<li >
    <a href="../comparer_functions/">Comparer Functions</a>
</li>

                        
                            
<li class="active">
    <a href="./">AsciiMath Renderer Definitions</a>
</li>

                        
                            
<li >
    <a href="../integral_grader/">IntegralGrader</a>
</li>

                        
                            
<li >
    <a href="../sum_grader/">SumGrader</a>
</li>

                        
                            
<li >
    <a href="../interval_grader/">IntervalGrader</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Grading Lists <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../grading_lists/single_list_grader/">SingleListGrader</a>
</li>

                        
                            
<li >
    <a href="../../grading_lists/list_grader/">ListGrader</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../plugins/">Plugins</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../faq/">FAQs</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../changelog/">Changelog</a>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../comparer_functions/">
                            <i class="fas fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../integral_grader/">
                            Next <i class="fas fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/mitodl/mitx-grading-library"><i class="fab fa-github"></i> GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#asciimath-renderer-definitions">AsciiMath Renderer Definitions</a></li>
            <li class="second-level"><a href="#how-it-works">How it Works</a></li>
                
            <li class="second-level"><a href="#options">Options</a></li>
                
            <li class="second-level"><a href="#extending-definitions">Extending Definitions</a></li>
                
            <li class="second-level"><a href="#notes">Notes</a></li>
                
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="asciimath-renderer-definitions">AsciiMath Renderer Definitions<a class="headerlink" href="#asciimath-renderer-definitions" title="Permanent link"> # </a></h1>
<p>When math input is expected from students, edX offers a math preview that attempts to show their expression in normal mathematical notation. There are two ways to provide this preview:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">&lt;formulaequationinput/&gt;</span>
or
<span class="nt">&lt;textline</span><span class="w"> </span><span class="na">math=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>

<p>The <code>formulaequationinput</code> tag uses server-side parsing and rendering to display the preview to the student. By and large, the preview from <code>formulaequationinput</code> is better than that of <code>textline</code>, as it treats functions correctly, and displays a number of LaTeX symbols natively. The downsides to <code>formulaequationinput</code> are that it doesn't recognize vectors such as <code>vecx</code> or <code>hatx</code>, the factorial and conjugation functions just apply as <code>fact(x)</code> and <code>conj(x)</code>, and because the processing is done server-side, we are unable to enhance the display at all.</p>
<p>The <code>textline</code> tag treats the student input as AsciiMath for the purpose of generating a preview, using MathJax to render it. While the preview does a reasonably good job, there are many situations where it falls down, even for standard edX functions (for example, try typing in <code>1/arctanh(x)</code> in a textline box!). Because this is done client-side through javascript, it's possible to supplement the AsciiMath definitions to handle new situations. We have constructed a series of renderer definitions to supplement the standard AsciiMath definitions in order to provide better previews.</p>
<p>This article describes how to use our new AsciiMath renderer definitions with a <code>&lt;textline&gt;</code> tag.</p>
<h2 id="how-it-works">How it Works<a class="headerlink" href="#how-it-works" title="Permanent link"> # </a></h2>
<p>The renderer definitions are located in a javascript file, <code>MJxPrep.js</code>, which should be uploaded to the static assets folder for your course. This javascript file has two components: symbol definitions and a preprocessor.</p>
<p>The symbol definitions are used to teach AsciiMath how to display various functions properly, such as <code>re</code>, <code>im</code>, <code>arctanh</code> etc. To load the symbol definitions in a problem, place the following HTML code somewhere in the problem.</p>
<div class="codehilite"><pre><span></span><code><span class="nt">&lt;script</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="w"> </span><span class="na">src=</span><span class="s">&quot;/static/MJxPrep.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div>

<p>Some functions are too complex for a symbol definition, and need the student's input to be preprocessed into AsciiMath before rendering. These functions include <code>log10</code>, <code>log2</code>, <code>fact</code>/<code>factorial</code>, <code>trans</code>, <code>adj</code>/<code>ctrans</code> and <code>cross</code>.</p>
<p>It is quite common to have a variable name begin with <code>delta</code> or <code>Delta</code>, such as <code>Deltax</code>. Unfortunately, AsciiMath treats such variables as two separate entries, and can sometimes split them inopportunely, such as for the expression <code>1/Deltax</code>. The preprocessor detects such variable names and ensures that AsciiMath displays them correctly.</p>
<p>To use these features, you need to add <code>preprocessorClassName</code> and <code>preprocessorSrc</code> properties to any <code>&lt;textline/&gt;</code> tags that use the preprocessor, such as in the following example.</p>
<div class="codehilite"><pre><span></span><code><span class="nt">&lt;customresponse</span><span class="w"> </span><span class="na">cfn=</span><span class="s">&quot;grader&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;textline</span><span class="w"> </span><span class="na">correct_answer=</span><span class="s">&quot;1/fact(5)&quot;</span><span class="w"> </span><span class="na">math=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">preprocessorClassName=</span><span class="s">&quot;MJxPrep&quot;</span><span class="w"> </span><span class="na">preprocessorSrc=</span><span class="s">&quot;/static/MJxPrep.js&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/customresponse&gt;</span>
</code></pre></div>

<p>If you use the preprocessor in your problem, you get the symbol definitions as well (you don't need to load them separately using a script tag).</p>
<h2 id="options">Options<a class="headerlink" href="#options" title="Permanent link"> # </a></h2>
<p>There are a few configurable options for the preprocessor in <code>MJxPrep.js</code>.</p>
<p>By default, <code>conj()</code> displays as a bar over the argument to the function. However, you may wish for complex conjugates to be displayed as a superscript star. If so, you can set <code>conj_as_star: true</code> at the start of the file.</p>
<p>By default, vectors <code>[1, 2, 3]</code> display as a column vector when the preprocessor is loaded (without the preprocessor, it will display as a row). If you would instead like them to display as a row vector, you can set the option <code>vectors_as_columns: false</code> at the start of the file.</p>
<h2 id="extending-definitions">Extending Definitions<a class="headerlink" href="#extending-definitions" title="Permanent link"> # </a></h2>
<p>If you're building a course that uses math extensively, it's likely that you want to use some sort of symbol that can't be written in the form of an edX variable. In this situation, we have provided two functions to extend the preprocessor. At the bottom of <code>MJxPrep.js</code>, you will find the functions <code>customPreReplacements</code> and <code>customPostReplacements</code>, which are called before and after our preprocessing functions occur, respectively. You can perform whatever manipulations you desire in these functions. As an example of a pre-replacement, consider the following line which implements the double factorial:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">working</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">replaceFunctionCalls</span><span class="p">(</span><span class="nx">working</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ffact&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">funcToPostfix</span><span class="p">(</span><span class="s1">&#39;!!&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>

<p>This leverages our <code>replaceFunctionCalls</code> and <code>funcToPostfix</code> functions which detect function calls and perform replacements, respectively (a number of other useful functions are included in the javascript file).</p>
<p>As an example of a post-replacement, the following line simply replaces a variable name with something that actually looks like a derivative:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">working</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">working</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/dphidx/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;{:(partial phi)/(partial x):}&#39;</span><span class="p">);</span>
</code></pre></div>

<p>This is a trivial example of using regex to make a replacement; of course, more complicated replacements are also possible.</p>
<p>Finally, if you want to introduce new symbols to AsciiMath using unicode, it's simple to do so. Here's an example of how we introduce hbar to the system:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// This is hbar, often used in physics</span>
<span class="nx">AM</span><span class="p">.</span><span class="nx">newsymbol</span><span class="p">({</span>
<span class="w">  </span><span class="nx">input</span><span class="o">:</span><span class="s2">&quot;hbar&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">tag</span><span class="o">:</span><span class="s2">&quot;mo&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">output</span><span class="o">:</span><span class="s2">&quot;\u210F&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">tex</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nx">ttype</span><span class="o">:</span><span class="nx">AM</span><span class="p">.</span><span class="nx">TOKEN</span><span class="p">.</span><span class="nx">CONST</span><span class="p">});</span>
</code></pre></div>

<h2 id="notes">Notes<a class="headerlink" href="#notes" title="Permanent link"> # </a></h2>
<ul>
<li>
<p>You can take advantage of the symbol definitions and preprocessor even if you're not using the grading library at all. Just load it up in any <code>textline</code> tags you're using. (We find the preprocessor so good that we use if for every math display problem in our courses!)</p>
</li>
<li>
<p>The javascript is constructed to only load its definitions once, no matter how many times the file is loaded. It's safe to use the preprocessor in as many <code>textline</code> boxes as you like.</p>
</li>
<li>
<p>The <a href="../functions_and_constants/">mathematical functions</a> article provides the complete list of functions that are corrected by the new AsciiMath renderer definitions.</p>
</li>
</ul></div>
        
        
    </div>

    
      <footer class="col-md-12 text-center">
          
          
            <hr>
            <p>
            <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</small>
            </p>
          

          
          
      </footer>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>

    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js"></script>
        
    <script>hljs.initHighlightingOnLoad();</script>
    

    <script>var base_url = "../.."</script>
    
    <script src="../../js/base.js"></script>
    <script src="../../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>
